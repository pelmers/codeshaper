exports.id=346,exports.ids=[346],exports.modules={346:(t,e,a)=>{"use strict";a.r(e),a.d(e,{drawCode:()=>y});var n=a(960),r=a(742),o=a(604),h=a(709),s=a(696);function i(t,e,a){const n=[];for(let r=0;r<e;r++)for(let e=0;e<t;e++){const o=r*t+e;a(r,e)&&(n.length>0&&e>0&&n[n.length-1][n[n.length-1].length-1]===o-1?n[n.length-1].push(o):n.push([o]))}return n}class c{static hex2lab(t){const[e,a,n,r]=c.hex2rgba(t),[o,h,s]=c.rgb2xyz(e,a,n,r);return c.xyz2lab(o,h,s)}static rgba2lab(t,e,a,n=1){const[r,o,h]=c.rgb2xyz(t,e,a,n);return c.xyz2lab(r,o,h)}static lab2rgba(t,e,a){const[n,r,o]=c.lab2xyz(t,e,a);return c.xyz2rgba(n,r,o)}static hex2rgba(t){let e;if("#"===t.charAt(0)&&(e=t.substring(1).split("")),e.length>6||e.length<3)throw new Error(`HEX colour must be 3 or 6 values. You provided it ${e.length}`);return 3===e.length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2]]),e="0x"+e.join(""),[e>>16&255,e>>8&255,255&e,1]}static rgb2xyz(t,e,a,n=1){return t>255?t=255:t<0&&(t=0),e>255?e=255:e<0&&(e=0),a>255?a=255:a<0&&(a=0),n>1?n=1:n<0&&(n=0),e/=255,a/=255,(t/=255)>.04045?t=Math.pow((t+.055)/1.055,2.4):t/=12.92,e>.04045?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,a>.04045?a=Math.pow((a+.055)/1.055,2.4):a/=12.92,[.4124564*(t*=100)+.3575761*(e*=100)+.1804375*(a*=100),.2126729*t+.7151522*e+.072175*a,.0193339*t+.119192*e+.9503041*a]}static xyz2rgba(t,e,a){let n=t/100,r=e/100,o=a/100,h=3.2404542*n+-1.5371385*r+-.4985314*o,s=-.969266*n+1.8760108*r+.041556*o,i=.0556434*n+-.2040259*r+1.0572252*o;return h>.0031308?h=1.055*Math.pow(h,1/2.4)-.055:h*=12.92,s>.0031308?s=1.055*Math.pow(s,1/2.4)-.055:s*=12.92,i>.0031308?i=1.055*Math.pow(i,1/2.4)-.055:i*=12.92,[Math.round(255*h),Math.round(255*s),Math.round(255*i),1]}static xyz2lab(t,e,a){return e/=100,a/=107.304,t=(t/=94.811)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116)-16,500*(t-e),200*(e-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]}static lab2xyz(t,e,a){let n=(t+16)/116,r=e/500+n,o=n-a/200;return n=Math.pow(n,3)>.008856?Math.pow(n,3):(n-16/116)/7.787,r=Math.pow(r,3)>.008856?Math.pow(r,3):(r-16/116)/7.787,o=Math.pow(o,3)>.008856?Math.pow(o,3):(o-16/116)/7.787,[94.811*r,100*n,107.304*o]}static deltaE00(t,e,a,n,r,o){Math.rad2deg=function(t){return 360*t/(2*Math.PI)},Math.deg2rad=function(t){return 2*Math.PI*t/360};const h=(t+n)/2,s=(Math.sqrt(Math.pow(e,2)+Math.pow(a,2))+Math.sqrt(Math.pow(r,2)+Math.pow(o,2)))/2,i=(1-Math.sqrt(Math.pow(s,7)/(Math.pow(s,7)+Math.pow(25,7))))/2,c=e*(1+i),l=r*(1+i),d=Math.sqrt(Math.pow(c,2)+Math.pow(a,2)),u=Math.sqrt(Math.pow(l,2)+Math.pow(o,2)),M=(d+u)/2;let g=Math.rad2deg(Math.atan2(a,c));g<0&&(g+=360);let p=Math.rad2deg(Math.atan2(o,l));p<0&&(p+=360);const w=Math.abs(g-p)>180?(g+p+360)/2:(g+p)/2,f=1-.17*Math.cos(Math.deg2rad(w-30))+.24*Math.cos(Math.deg2rad(2*w))+.32*Math.cos(Math.deg2rad(3*w+6))-.2*Math.cos(Math.deg2rad(4*w-63));let x=p-g;Math.abs(x)>180&&(p<=g?x+=360:x-=360);const b=n-t,m=u-d;x=2*Math.sqrt(d*u)*Math.sin(Math.deg2rad(x)/2);const v=1+.015*Math.pow(h-50,2)/Math.sqrt(20+Math.pow(h-50,2)),y=1+.045*M,$=1+.015*M*f,q=30*Math.exp(-Math.pow((w-275)/25,2)),E=-2*Math.sqrt(Math.pow(M,7)/(Math.pow(M,7)+Math.pow(25,7)))*Math.sin(2*Math.deg2rad(q));return Math.sqrt(Math.pow(b/(1*v),2)+Math.pow(m/(1*y),2)+Math.pow(x/(1*$),2)+E*(m/(1*y))*(x/(1*$)))}static getDarkerColour(t,e,a,n=1,r=.05){let[o,h,s]=c.rgba2lab(t,e,a,n);return o-=o*r,o<0&&(o=0),c.lab2rgba(o,h,s)}static getBrighterColour(t,e,a,n=1,r=.05){let[o,h,s]=c.rgba2lab(t,e,a,n);return o+=o*r,o>100&&(o=100),c.lab2rgba(o,h,s)}}var l=a(8),d=a.n(l);const u=256/r.p$,M=t=>Math.floor(t/u),g=(t,e,a)=>M(t)*r.p$*r.p$+M(e)*r.p$+M(a),p=new Array(Math.pow(r.p$,3)).fill(0).map(((t,e)=>{const a=Math.floor(e/(r.p$*r.p$)),n=Math.floor((e-a)/r.p$);return[(a+.5)*u,(n+.5)*u,(e-a-n+.5)*u]})),w=new(d())({max:2*Math.pow(r.p$,3)});function f(t,e,a){const n=[t,e,a].join(" "),r=w.get(n);if(null!=r)return r;{const r=c.rgba2lab(t,e,a);return w.set(n,r),r}}class x{constructor(t){this.compressed=[],this.originalToCompressedMap=new Map;const e=t.reduce(((t,e)=>t+e),0),a=Math.round(.95*e),n=t.map(((t,e)=>({v:t,idx:e}))).sort(((t,e)=>e.v-t.v));let r,o;for(r=0,o=0;r<n.length&&o<a;r++){const{v:t,idx:e}=n[r];o+=t,this.compressed.push({originalIndex:e,count:t}),this.originalToCompressedMap.set(e,this.compressed.length-1)}for(;r<n.length;r++){const{v:t,idx:e}=n[r],[a,o,h]=p[e],[s,i,l]=f(a,o,h);let d=Number.MAX_SAFE_INTEGER,u=0;for(const{delta:t,idx:e}of this.compressed.map((({originalIndex:t},e)=>{const[a,n,r]=p[t],[o,h,d]=f(a,n,r);return{delta:c.deltaE00(s,i,l,o,h,d),idx:e}})))t<d&&(d=t,u=e);this.compressed[u].count+=t,this.originalToCompressedMap.set(e,u)}}saliency(t,e,a){const n=g(t,e,a),r=this.originalToCompressedMap.get(n);return this.compressed.reduce(((n,o,h)=>{if(h===r)return n;{const[r,h,s]=p[o.originalIndex];return n+o.count*((t,e,a,n,r,o)=>{const[h,s,i]=f(t,e,a),[l,d,u]=f(n,r,o);return c.deltaE00(h,s,i,l,d,u)})(t,e,a,r,h,s)}}),0)}}function b(t,e,a,n,c,l){return function(t,e,a,n){return new(a||(a=Promise))((function(r,o){function h(t){try{i(n.next(t))}catch(t){o(t)}}function s(t){try{i(n.throw(t))}catch(t){o(t)}}function i(t){var e;t.done?r(t.value):(e=t.value,e instanceof a?e:new a((function(t){t(e)}))).then(h,s)}i((n=n.apply(t,e||[])).next())}))}(this,void 0,void 0,(function*(){const d=new h.u((0,o.parse)(t)).generate().code,u=(0,s.jt)(d);c&&(n=1-n);const M=(0,s.rX)(u)*r.yU/n,{canvas:p,ctx:w}=yield l(e,M),f="saliency"===a?function(t,e,a,n){const o=e.getImageData(0,0,t.width,t.height),h=new Array(Math.pow(r.p$,3)).fill(0);for(let t=0;t<o.data.length;t+=4){const[e,a,n]=o.data.slice(t,t+3);h[g(e,a,n)]++}const s=new x(h),c=new Array(t.width*t.height);for(let t=0;t<o.data.length;t+=4){const[e,a,n]=o.data.slice(t,t+3);c[t/4]=s.saliency(e,a,n)}const l=c.concat().sort(((t,e)=>n?t-e:e-t)),d=l[Math.round(a*l.length)];return i(o.width,o.height,((t,e)=>{const a=t*o.width+e;return n?c[a]<=d:c[a]>=d}))}(p,w,n,c):function(t,e,a,n){const o=e.getImageData(0,0,t.width,t.height),h=new Array(r.Ro).fill(0);for(let t=0;t<o.data.length;t+=4){const[e,a,n,r]=o.data.slice(t,t+4);h[Math.round(r/255*(e+a+n))]++}const s=o.width*o.height*a;let c=0,l=h.length-1;for(n&&h.reverse();c<s&&l>0;)c+=h[l],l--;return n&&(l=h.length-1-l),i(o.width,o.height,((t,e)=>{const a=t*o.width+e,[r,h,s,i]=o.data.slice(4*a,4*(a+1)),c=Math.round(i/255*(r+h+s));return n?c<=l:c>=l}))}(p,w,n,c),b=(0,s.XL)(u,(t=>t<f.length?f[t].length:Number.MAX_SAFE_INTEGER));if(b.length>f.length+1)throw new Error(`Unexpected segment length of ${b.length} from ${f.length} runs`);for(;b.length<f.length;){const t=f[b.length].length;t>5?b.push(`/*${"o".repeat(t-4)}*/`):b.push(" ".repeat(t))}let m="",v=0;for(let t=0;t<p.height;t++){for(let e=0;e<p.width;e++){const a=t*p.width+e;v<f.length&&a>=f[v][0]?(m+=b[v]+" ",e+=b[v].length,v++):m+=" "}m+="\n"}for(let t=v;t<b.length;t++)m+=`\n${b[t]}`;return m}))}var m=function(t,e,a,n){return new(a||(a=Promise))((function(r,o){function h(t){try{i(n.next(t))}catch(t){o(t)}}function s(t){try{i(n.throw(t))}catch(t){o(t)}}function i(t){var e;t.done?r(t.value):(e=t.value,e instanceof a?e:new a((function(t){t(e)}))).then(h,s)}i((n=n.apply(t,e||[])).next())}))};function v(t,e){return m(this,void 0,void 0,(function*(){const a=yield(0,n.loadImage)(t),o=Math.sqrt(e/(a.width*a.height)),h=Math.round(a.width*o*Math.sqrt(r.xO)),s=Math.round(a.height*o/Math.sqrt(r.xO)),i=(0,n.createCanvas)(h,s),c=i.getContext("2d");return c.drawImage(a,0,0,i.width,i.height),{canvas:i,ctx:c}}))}function y(t,e,a,n,r){return m(this,void 0,void 0,(function*(){return b(t,e,a,n,r,v)}))}}};